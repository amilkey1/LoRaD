---
title: "k80-Vignette"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{k80-Vignette}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

```{r setup}
#library(LoRaD)
```

In this vignette, we explain how one can compute marginal likelihood using the LoRaD method. 

# Model and Data
The data were simulated under the k80 model. This model has two parameters, kappa and edge-length. The data contained in the file k80-samples.txt. In the file there are four columns, iter(mcmc-iteration), log-kernal(transformed log posterior kernal), edgelen(sampled edge length), and kappa(sampled kappa parameter). The file contains 10,000 iterations from 1,000,000 mcmc samples reported every 100 iterations. 

In this example we will compute the marginal likelihood under this model. 

First, we read in the data. 

```{r}
library(LoRaD)
params <- read.table('k80-samples.txt', header=TRUE)

```

# Column Specification 
Next, we will define the columns as follows: 
iteration : The mcmc iteration
posterior : The column is included in the posterior
positive : The parameter is positive
unconstrained : The parameter value is any real number
ignore : The column should be ignored

In our example date we specified the columns as follows:
iter : iteration
log.kernal : posterior 
edgelen : positive
kappa : positive

```{r}
# Create a data frame holding the column specifications
colspec <- c("iter"="iteration", "log.kernel"="posterior", "edgelen"="positive", "kappa"="positive")
```

# Computing the Log Marginal Likelihood
To run the LoRaD function we would need to specify the training fraction, the training sample selection method, and the coverage fraction. The training fraction and the coverage fraction must be between 0 and 1. The training sample selection method can be left(the first part of the sample), right(the second part of the sample), or random(a random part of the sample).

For this example we chose 0.5 for the training fraction and the coverage fraction and left for the training sample selection method. 

```{r}
lorad(params, colspec, 0.5, "left", 0.5, "k80-samples.txt")
```

The log marginal likelhood is -454.716964.









