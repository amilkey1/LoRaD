-180931.141
-180941.1793
-180949.0761
-180960.9037
-181739.3058
-181832.3344
-182380.8831)
lorad <- c(-180950.338
-180959.2968
-180918.6291
-180915.9857
-181006.6747
-180958.9215
-180992.9603
-180969.0212
-181063.4758
-181044.8184
-180922.5511
-181103.6756
-180923.9818
-180926.889
-180926.7748
-180932.6694
-180942.9246
-181050.5058
-181000.6368
-182064.2168
-182080.5346
-182651.2576)
smc <- c(-180901.6669
-180905.6362
-180906.2436
-180906.38
-180909.4193
-180910.1223
-180910.3661
-180910.9945
-180911.671
-180912.7376
-180914.9619
-180915.6034
-180925.845
-180926.0698
-180927.1639
-180931.141
-180941.1793
-180949.0761
-180960.9037
-181739.3058
-181832.3344
-182380.8831)
lorad <- c(-180950.338
-180959.2968
-180918.6291
-180915.9857
-181006.6747
-180958.9215
-180992.9603
-180969.0212
-181063.4758
-181044.8184
-180922.5511
-181103.6756
-180923.9818
-180926.889
-180926.7748
-180932.6694
-180942.9246
-181050.5058
-181000.6368
-182064.2168
-182080.5346
-182651.2576)
head(smc)
head(lorad)
plot(smc~lorad)
plot(smc~lorad)
rep <- c(1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22)
dif <- c(48.671116
53.660582
12.385538
9.60574
97.255406
48.799178
82.594198
58.026681
151.804815
132.080773
7.58922
188.072178
-1.863145
0.819221
-0.389042
1.528454
1.745323
101.4297
39.733048
324.910983
248.200173
270.374526)
270.374526
dif <- c(48.671116
53.660582
12.385538
9.60574
97.255406
48.799178
82.594198
58.026681
151.804815
132.080773
7.58922
188.072178
-1.863145
0.819221
-0.389042
1.528454
1.745323
101.4297
39.733048
324.910983
248.200173
270.374526)
dif <- c(48.671116
dif <- c(48.671116
53.660582
12.385538
9.60574
97.255406
48.799178
82.594198
58.026681
151.804815
132.080773
7.58922
188.072178
-1.863145
0.819221
-0.389042
1.528454
1.745323
101.4297
39.733048
324.910983
248.200173
270.374526)
smc <- c(-180901.6669
-180905.6362
-180906.2436
-180906.38
-180909.4193
-180910.1223
-180910.3661
-180910.9945
-180911.671
-180912.7376
-180914.9619
-180915.6034
-180925.845
-180926.0698
-180927.1639
-180931.141
-180941.1793
-180949.0761
-180960.9037
-181739.3058
-181832.3344
-182380.8831)
dfi <- c(1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22)
diff <- c(1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22)
rep <- c(1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22)
diff <- c(48.671116
53.660582
12.385538
9.60574
97.255406
48.799178
82.594198
58.026681
151.804815
132.080773
7.58922
188.072178
-1.863145
0.819221
-0.389042
1.528454
1.745323
101.4297
39.733048
324.910983
248.200173
270.374526)
diff <- c(48.671116,
53.660582,
12.385538,
9.60574,
97.255406,
48.799178,
82.594198,
58.026681,
151.804815,
132.080773,
7.58922,
188.072178,
-1.863145,
0.819221,
-0.389042,
1.528454,
1.745323,
101.4297,
39.733048,
324.910983,
248.200173,
270.374526)
plot(rep~diff)
plot(diff~rep)
pot(smc, rep)
plot(smc, rep)
plot()
plot(smc, rep)
length(smc)
lenth(rep)
length(rep)
smc <- c(-180901.6669,
-180905.6362,
-180906.2436,
-180906.38,
-180909.4193,
-180910.1223,
-180910.3661,
-180910.9945,
-180911.671,
-180912.7376,
-180914.9619,
-180915.6034,
-180925.845,
-180926.0698,
-180927.1639,
-180931.141,
-180941.1793,
-180949.0761,
-180960.9037,
-181739.3058,
-181832.3344,
-182380.8831)
lorad <- c(-180950.338,
-180959.2968,
-180918.6291,
-180915.9857,
-181006.6747,
-180958.9215,
-180992.9603,
-180969.0212,
-181063.4758,
-181044.8184,
-180922.5511,
-181103.6756,
-180923.9818,
-180926.889,
-180926.7748,
-180932.6694,
-180942.9246,
-181050.5058,
-181000.6368,
-182064.2168,
-182080.5346,
-182651.2576)
plot(smc, rep)
plot(rep~smc)
plot(smc~rep)
plot(smc~rep, lorad~rep)
plot(rep, smc)
plot(rep, lorad)
par(mar=c(5,4,4,4)+0.3)
plot(rep, smc, pch=16, col=2)
par(new=TRUE)
plot(rep, lorad, pch=17, col=3, axes=FALSE, xlab="", ylab="")
axis(side=4, at=pretty(range(y2)))
smc <- c(-180901.6669,
-180905.6362,
-180906.2436,
-180906.38,
-180909.4193,
-180910.1223,
-180910.3661,
-180910.9945,
-180911.671,
-180912.7376,
-180914.9619,
-180915.6034,
-180925.845,
-180926.0698,
-180927.1639,
-180931.141,
-180941.1793,
-180949.0761,
-180960.9037)
lorad <- c(-180950.338,
-180959.2968,
-180918.6291,
-180915.9857,
-181006.6747,
-180958.9215,
-180992.9603,
-180969.0212,
-181063.4758,
-181044.8184,
-180922.5511,
-181103.6756,
-180923.9818,
-180926.889,
-180926.7748,
-180932.6694,
-180942.9246,
-181050.5058,
-181000.6368,)
lorad <- c(-180950.338,
-180959.2968,
-180918.6291,
-180915.9857,
-181006.6747,
-180958.9215,
-180992.9603,
-180969.0212,
-181063.4758,
-181044.8184,
-180922.5511,
-181103.6756,
-180923.9818,
-180926.889,
-180926.7748,
-180932.6694,
-180942.9246,
-181050.5058,
-181000.6368)
rep <- c(1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19)
diff <- c(48.671116,
53.660582,
12.385538,
9.60574,
97.255406,
48.799178,
82.594198,
58.026681,
151.804815,
132.080773,
7.58922,
188.072178,
-1.863145,
0.819221,
-0.389042,
1.528454,
1.745323,
101.4297,
39.733048,)
par(mar=c(5,4,4,4)+0.3)
plot(rep, smc, pch=16, col=2)
par(new=TRUE)
plot(rep, lorad, pch=17, col=3, axes=FALSE, xlab="", ylab="")
axis(side=4, at=pretty(range(y2)))
library(LoRaD)
remove.packages("LoRaD")
#
library(diversitree)
## subdivide our plot and set margins
par(mfrow=c(1,2),mar=c(0.1,1.1,2.1,1.1))
## panel a)
## set BiSSE parameter values
pars<-setNames(
c(0.1,0.3,0.01,0.01,0.03,0.03), c("lambda0","lambda1","mu0,","mu1",
"q01","q10"))
pars
## simulate BiSSE tree
phy.bisse<-tree.bisse(pars,max.taxa=80,x0=0)
h<-history.from.sim.discrete(phy.bisse,0:1) ## plot simulated tree
plot(h,phy.bisse,show.tip.label=FALSE, cols=c("black","grey"),cex=0.7)
## add panel label
mtext("(a)",lwd=1,adj=0,font=1)
## panel b)
## set non-BiSSE simulation parameter values
pars<-setNames(c(0.2,0.2,0.01,0.01,0.03,0.03), c("lambda0","lambda1","mu0","mu1", "q01","q10"))
pars
## simulate state-independent diversification
phy.nonbisse<-tree.bisse(pars,max.taxa=80,x0=0)
h<-history.from.sim.discrete(phy.nonbisse,0:1) ## plot results
plot(h,phy.nonbisse,show.tip.label=FALSE, cols=c("black","gray"),cex=0.7) ## add panel label
mtext("(b)",lwd=1,adj=0,font=1)
library(geiger)
library(phytools)
gt<-read.tree("grunts.phy")
print(gt,printlen=2)
gd<-read.csv("grunts.csv",row.names=1, stringsAsFactors=TRUE)
head(gd)
## extract habitat data
hab<-gd[,1]
## set names
names(hab) <- rownames(gd)
## plot our tree
plotTree(gt, ftype="i", fsize=0.7, offset=0.5)
## add tip labels
tiplabels(pie=to.matrix(hab,0:1)[gt$tip.label,], piecol=c("white", "black"), cex=0.4)
## create legend
legend("bottomleft",c("non-reef","reef"), pch=21,pt.cex=1.6, cex=0.8,bty="n", pt.bg=c("white","black"))
## make BiSSE likelihood function
bisse.model<-make.bisse(gt,hab)
## find reasonable parameter values for ## optimization
p<-starting.point.bisse(gt)
p # MLE values for parameters
fit.bd(gt)
## optimize BiSSE model
bisse.mle<-find.mle(bisse.model,p)
bisse.mle # MLE 2x as high as speciation rate of non-reef fish
# fit null model too - constrained likelihood function
## create constrained null model
bissenull.model<-constrain(bisse.model, lambda1~lambda0,mu1~mu0)
## optimize null model
bissenull.mle<-find.mle(bissenull.model, p[c(-2,-4)])
# print fitted model coefficients & likelihood
coef(bissenull.mle)
logLik(bissenull.mle)
## run likelihood-ratio test
bisseAnova<-anova(bisse.mle, null=bissenull.mle)
bisseAnova
aicw(setNames(bisseAnova$AIC, rownames(bisseAnova)))
# weak support for BiSSE model
# 11.2.2 Analyzing a BiSSE model using Bayesian MCMC
prior<-make.prior.exponential(1/(2*0.4))
prior
## run Bayesian MCMC
bisse.mcmc<-mcmc(bisse.model,bisse.mle$par, nsteps=1000,prior=prior,w=0.1, print.every=100)
#  visualize posterior distribution of 2 different params in our model
## subdivide plot and set margins
par(mfrow=c(1,2),mar=c(5.1,4.1,3.1,2.1)) ## set colors for plotting
col<-setNames(c("blue", "red"), c("non-reef","reef"))
## create graph of posterior sample for lambda
profiles.plot(bisse.mcmc[,c("lambda0","lambda1")], col.line=col,las=1,bty="n", xlab=expression(lambda),cex.axis=0.7)
x <- rbeta(100000,4,12)
y <- ifelse(x <= 0.5,x,1-x)
plot(density(y), xlim=c(0, 0.5))
curve(dbeta(x,4,12)-dbeta(1-x,4,12),col="red", add=T)
install.packages("testthat")
install.packages("testthat")
install.packages("testthat")
install.packages("testthat")
usethis::use_test("test")
setwd("/Users/analisamilkey/Documents/projects/LoRaD/LoRaD/test")
setwd("/Users/analisamilkey/Documents/projects/LoRaD/LoRaD/test
usethis::use_test("test-name")
test_that("multiplication works", {
expect_equal(2 * 2, 4)
})
library(test_that)
install.packages("testthat")
test_that("multiplication works", {
expect_equal(2 * 2, 4)
})
install.packages("test_that")
test_that("multiplication works", {
expect_equal(2 * 2, 4)
})
library(test_that)
library(testthat)
library("test_that")
install.packages("testthat")
library(testthat)
update.packages(ask = FALSE)
library(testthat)
install.packages("testthat")
library(testthat)
